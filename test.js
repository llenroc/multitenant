var nJwt = require("njwt");
var aadutils = require("./aadutils.js");

var t = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1uQ19WWmNBVGZNNXBPWWlKSE1iYTlnb0VLWSIsImtpZCI6Ik1uQ19WWmNBVGZNNXBPWWlKSE1iYTlnb0VLWSJ9.eyJhdWQiOiJodHRwOi8vdGVzdGF1dGgucGxhc25lLmNvbS8iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83MmY5ODhiZi04NmYxLTQxYWYtOTFhYi0yZDdjZDAxMWRiNDcvIiwiaWF0IjoxNDU4MDQ4ODAxLCJuYmYiOjE0NTgwNDg4MDEsImV4cCI6MTQ1ODA1MjcwMSwiYWNyIjoiMSIsImFtciI6WyJ3aWEiXSwiYXBwaWQiOiJlNTRiMDRjNi02ZTJiLTQ1ZTgtOThlYi03OGI1NjE2Mjc2ZDIiLCJhcHBpZGFjciI6IjAiLCJkZXZpY2VpZCI6IjY0NjU0MmJiLTM3YTAtNDYxNC1iNzc3LTYxN2NmNjIyNjA3NCIsImZhbWlseV9uYW1lIjoiTGFzbmUiLCJnaXZlbl9uYW1lIjoiUGV0ZXIiLCJpbl9jb3JwIjoidHJ1ZSIsImlwYWRkciI6IjE3NC4xMDguODQuNzQiLCJuYW1lIjoiUGV0ZXIgTGFzbmUiLCJvaWQiOiI5MGVjOTA1YS05NTdiLTRkMTAtOGJhZC1lZTk3NWYxZmQzNzIiLCJvbnByZW1fc2lkIjoiUy0xLTUtMjEtMTI0NTI1MDk1LTcwODI1OTYzNy0xNTQzMTE5MDIxLTE1MTk0MjgiLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJzdWIiOiJ0STdtVWVhRnkySjJQMEF4c0tiejNFSlVfYUxKQ2NmS0F1MktBTmxTSUlNIiwidGlkIjoiNzJmOTg4YmYtODZmMS00MWFmLTkxYWItMmQ3Y2QwMTFkYjQ3IiwidW5pcXVlX25hbWUiOiJwZWxhc25lQG1pY3Jvc29mdC5jb20iLCJ1cG4iOiJwZWxhc25lQG1pY3Jvc29mdC5jb20iLCJ2ZXIiOiIxLjAifQ.ISoYJMqUhVO0wLEXA51Lgbw7voUZ3AG53dLkuItk89Q6w1ztmJx17NQ5LQ9ziUFp9T5WTd3uiniGRs_k-gh0dFSMicOj_QzPnzktg1cO0uvg9Qd04y56OcIlneyWjx6xfKbcyXTST70g0tbAWYsbLCYXp5sXstxHuy9HTSy6EaCZln8CiOeqBlo2rqthwiqWi6zrpku4eqyx3Whzx1uLcwrpAfmZusyAhJDCP2P2kVBCqbLiEQMQqCCLsLXyH-yMwUPCXPeOwJt79vF1vfjQ2szvGXtyyPqC5wt0TX01ihHZouDMk8__jLxrAk3DWGl8egRvCfDZBf7BGzwnxDBhiw";

var n = "vIqz-4-ER_vNWLON9yv8hIYV737JQ6rCl6XfzOC628seYUPf0TaGk91CFxefhzh23V9Tkq-RtwN1Vs_z57hO82kkzL-cQHZX3bMJD-GEGOKXCEXURN7VMyZWMAuzQoW9vFb1k3cR1RW_EW_P-C8bb2dCGXhBYqPfHyimvz2WarXhntPSbM5XyS5v5yCw5T_Vuwqqsio3V8wooWGMpp61y12NhN8bNVDQAkDPNu2DT9DXB1g0CeFINp_KAS_qQ2Kq6TSvRHJqxRR68RezYtje9KAqwqx4jxlmVAQy0T3-T-IAbsk1wRtWDndhO6s1Os-dck5TzyZ_dNOhfXgelixLUQ";

var e = "AQAB";

var modulus = new Buffer(n, "base64");
var exponent = new Buffer(e, "base64");
var k = aadutils.rsaPublicKeyPem(modulus, exponent);

nJwt.verify(t, k, "RS256", function(err, val) {
  if (err) {
    console.log(err);
  } else {
    console.log("verified");
    console.log(val);
  }
});

